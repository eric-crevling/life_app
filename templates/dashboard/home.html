{% extends "base.html" %}
{% block title %}HomeBase{% endblock %}
{% block content %}
    <div class="max-w-lg mx-auto space-y-6">
        <!-- Header -->
        <div class="flex justify-between items-center">
            <h1 class="text-2xl font-bold">HomeBase</h1>
            {% if streak > 0 %}<span class="badge badge-primary badge-lg">{{ streak }} day streak ðŸ”¥</span>{% endif %}
        </div>
        <!-- Quick Actions -->
        <div class="grid grid-cols-2 gap-3">
            <a href="{% url 'tracking:meal_list' %}" class="btn btn-primary">Log Meal</a>
            <a href="{% url 'tracking:workout_list' %}" class="btn btn-secondary">Log Workout</a>
            <a href="{% url 'tracking:weighin_list' %}" class="btn btn-accent">Log Weigh-in</a>
            <a href="{% url 'goals:goal_overview' %}" class="btn btn-ghost">Goals</a>
        </div>
        <!-- Macros -->
        <div class="card bg-base-100 shadow">
            <div class="card-body">
                <h2 class="card-title text-base">Today's Macros</h2>
                {% if macro_goal %}
                    <div class="space-y-3">
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>Calories</span>
                                <span>{{ totals.total_calories }} / {{ macro_goal.calories }}</span>
                            </div>
                            <progress class="progress progress-primary w-full"
                                      value="{{ macro_progress.calories }}"
                                      max="100"></progress>
                        </div>
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>Protein</span>
                                <span>{{ totals.total_protein }}g / {{ macro_goal.protein }}g</span>
                            </div>
                            <progress class="progress progress-secondary w-full"
                                      value="{{ macro_progress.protein }}"
                                      max="100"></progress>
                        </div>
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>Carbs</span>
                                <span>{{ totals.total_carbs }}g / {{ macro_goal.carbs }}g</span>
                            </div>
                            <progress class="progress progress-accent w-full"
                                      value="{{ macro_progress.carbs }}"
                                      max="100"></progress>
                        </div>
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>Fat</span>
                                <span>{{ totals.total_fat }}g / {{ macro_goal.fat }}g</span>
                            </div>
                            <progress class="progress progress-warning w-full"
                                      value="{{ macro_progress.fat }}"
                                      max="100"></progress>
                        </div>
                    </div>
                {% else %}
                    <p class="text-base-content/60">
                        No macro goals set. <a href="{% url 'goals:goal_overview' %}" class="link link-primary">Set goals</a>
                    </p>
                {% endif %}
            </div>
        </div>
        <!-- Water -->
        <div class="card bg-base-100 shadow">
            <div class="card-body flex-row justify-between items-center">
                <h2 class="card-title text-base">Water</h2>
                {% include "tracking/partials/water_display.html" %}
            </div>
        </div>
        <!-- Today's Workouts -->
        <div class="card bg-base-100 shadow">
            <div class="card-body">
                <h2 class="card-title text-base">Today's Workouts</h2>
                {% for workout in todays_workouts %}
                    <a href="{% url 'tracking:workout_detail' workout.pk %}"
                       class="flex justify-between items-center py-1">
                        <span class="font-bold">{{ workout.category|default:"Workout" }}</span>
                        <span class="text-sm text-base-content/60">{{ workout.exercises.count }} exercises</span>
                    </a>
                {% empty %}
                    <p class="text-base-content/60">No workouts today.</p>
                {% endfor %}
            </div>
        </div>
        <!-- Weight -->
        <div class="card bg-base-100 shadow">
            <div class="card-body">
                <h2 class="card-title text-base">Weight</h2>
                {% if latest_weighin %}
                    <div class="flex justify-between items-center">
                        <div>
                            <span class="text-2xl font-bold">{{ latest_weighin.weight }} lbs</span>
                            <span class="text-sm text-base-content/60 ml-2">{{ latest_weighin.date }}</span>
                        </div>
                        {% if weight_goal %}<span class="text-sm">Goal: {{ weight_goal.target_weight }} lbs</span>{% endif %}
                    </div>
                {% else %}
                    <p class="text-base-content/60">No weigh-ins yet.</p>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}
